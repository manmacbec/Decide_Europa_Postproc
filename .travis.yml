language: python 
python: 
- "3.6"
services:
- postgresql
env: 
- DJANGO=2.0 DB=postgres
global:
  - PGPORT=5432
before_install: 
- cd decide
install: 
- pip install -r ../requirements.txt
before_script: 
- cp local_settings.travis.py local_settings.py
- psql -c "create user decide with password 'decide'"
- psql -c "ALTER USER decide WITH SUPERUSER;"
- psql -c "create database decide owner decide"
- python manage.py migrate
script: 
- python manage.py test
- >-
    curl -s -X POST -H \"Content-Type: application/json2" 
    -H "Accept: application/json" 
    -H "Travis-API-Version: 3" 
    -H "Authorization: token FNUcEMrnT1oTGKWpK3kqEw" 
    -d '{"tag_name": "wea", "name":"wea2.0"}' 
    https://github.com/manmacbec/Decide_Europa_Postproc/releases
addons:
  postgresql: "9.6"
